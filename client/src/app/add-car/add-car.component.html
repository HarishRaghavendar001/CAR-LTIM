


<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>


<body>
  <div class="container-fluid main-bg">
    <!-- ðŸŒ Glassy Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark glass-nav  mx-3 rounded-3 shadow-sm">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold d-flex align-items-center">
          <i class="fas fa-car-alt me-2"></i>
          <span class="ride">CAR</span><span class="on">z</span><span class="ride">Y</span>
        </a>
        <div class="d-flex ms-auto">
          <a routerLink="/dashboard" class="btn btn-outline-info">
            <i class="fas fa-tachometer-alt me-1"></i> Dashboard
          </a>
        </div>
      </div>
    </nav>

    <!-- ðŸš˜ Dashboard Content -->
    <div class="container py-4">
      <h2 class="dashboard-title text-center mb-4 text-white">
         Car Management
      </h2>

      <div class="row g-4">
        <!-- ðŸ§¾ Add/Update Car Form -->
        <div class="col-lg-5">
          <div class="card shadow-lg p-3 form-card">
            <div class="card-header text-center fw-bold bg-black text-white">
              <i class="fas" [ngClass]="isEditMode ? 'fa-edit' : 'fa-plus-circle'"></i>
              {{ isEditMode ? 'Update Car' : 'Add Car' }}
            </div>

            <div class="card-body">
              <form [formGroup]="itemForm" (ngSubmit)="onSubmit()">
                <!-- Make -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-industry"></i> Make</label>
                  <input type="text" formControlName="make" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('make')?.valid && (itemForm.get('make')?.touched || itemForm.get('make')?.dirty),
                      'is-invalid': itemForm.get('make')?.invalid && (itemForm.get('make')?.touched || itemForm.get('make')?.dirty)
                    }"/>
                  <div *ngIf="itemForm.get('make')?.invalid && (itemForm.get('make')?.touched || itemForm.get('make')?.dirty)" class="invalid-feedback">
                    Make is required
                  </div>
                </div>

                <!-- Model -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-car-side"></i> Model</label>
                  <input type="text" formControlName="model" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('model')?.valid && (itemForm.get('model')?.touched || itemForm.get('model')?.dirty),
                      'is-invalid': itemForm.get('model')?.invalid && (itemForm.get('model')?.touched || itemForm.get('model')?.dirty)
                    }"/>
                  <div *ngIf="itemForm.get('model')?.invalid && (itemForm.get('model')?.touched || itemForm.get('model')?.dirty)" class="invalid-feedback">
                    Model is required
                  </div>
                </div>

                <!-- Manufacture Year -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-calendar-alt"></i> Manufacture Year</label>
                  <input type="text" formControlName="manufactureYear" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('manufactureYear')?.valid && (itemForm.get('manufactureYear')?.touched || itemForm.get('manufactureYear')?.dirty),
                      'is-invalid': itemForm.get('manufactureYear')?.invalid && (itemForm.get('manufactureYear')?.touched || itemForm.get('manufactureYear')?.dirty)
                    }"/>
                  <div *ngIf="itemForm.get('manufactureYear')?.invalid && (itemForm.get('manufactureYear')?.touched || itemForm.get('manufactureYear')?.dirty)" class="invalid-feedback">
                    Enter valid year (e.g. 2021)
                  </div>
                </div>

                <!-- Registration Number -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-id-card"></i> Registration Number</label>
                  <input type="text" formControlName="registrationNumber" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('registrationNumber')?.valid && (itemForm.get('registrationNumber')?.touched || itemForm.get('registrationNumber')?.dirty),
                      'is-invalid': itemForm.get('registrationNumber')?.invalid && (itemForm.get('registrationNumber')?.touched || itemForm.get('registrationNumber')?.dirty)
                    }"/>
                  <div *ngIf="itemForm.get('registrationNumber')?.invalid && (itemForm.get('registrationNumber')?.touched || itemForm.get('registrationNumber')?.dirty)" class="invalid-feedback">
                    Enter valid number (e.g. TN49BH7898)
                  </div>
                </div>

                <!-- Status -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-info-circle"></i> Status</label>
                  <select formControlName="status" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('status')?.valid && itemForm.get('status')?.touched,
                      'is-invalid': itemForm.get('status')?.invalid && itemForm.get('status')?.touched
                    }">
                    <option value="">Select Status</option>
                    <option value="available">Available</option>
                    <option value="booked">Booked</option>
                  </select>
                  <div *ngIf="itemForm.get('status')?.invalid && itemForm.get('status')?.touched" class="invalid-feedback">
                    Status is required
                  </div>
                </div>

                <!-- Rental Rate -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-rupee-sign"></i> Rental Rate Per Day</label>
                  <input type="number" formControlName="rentalRatePerDay" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('rentalRatePerDay')?.valid && itemForm.get('rentalRatePerDay')?.touched,
                      'is-invalid': itemForm.get('rentalRatePerDay')?.invalid && itemForm.get('rentalRatePerDay')?.touched
                    }"/>
                  <!-- <div *ngIf="itemForm.get('rentalRatePerDay')?.invalid && itemForm.get('rentalRatePerDay')?.touched" class="invalid-feedback">
                    Rental rate is required
                  </div> -->
                  <div *ngIf="itemForm.get('rentalRatePerDay')?.hasError('required')" class="text-danger">
                    <i class="fas fa-exclamation-circle"></i> Rental Rate is required
                  </div>
                  <div *ngIf="itemForm.get('rentalRatePerDay')?.hasError('min')" class="text-danger">
                    <i class="fas fa-exclamation-circle"></i> Invalid Rental Rate
                  </div>
                  <div *ngIf="itemForm.get('rentalRatePerDay')?.hasError('pattern')" class="text-danger">
                    <i class="fas fa-exclamation-circle"></i> Wrong Amount,Must be > 0
                  </div>
                </div>

                <!-- Category -->
                <div class="mb-3">
                  <label class="form-label"><i class="fas fa-tags"></i> Category</label>
                  <select formControlName="category" class="form-control"
                    [ngClass]="{
                      'is-valid': itemForm.get('category')?.valid && itemForm.get('category')?.touched,
                      'is-invalid': itemForm.get('category')?.invalid && itemForm.get('category')?.touched
                    }">
                    <option value="">Select Category</option>
                    <option *ngFor="let cat of carCategories" [value]="cat.id">{{ cat.name }}</option>
                  </select>
                  <div *ngIf="itemForm.get('category')?.invalid && itemForm.get('category')?.touched" class="invalid-feedback">
                    Category is required
                  </div>
                </div>

                <button type="submit" class="btn btn-primary w-100 mt-3">
                  <i class="fas" [ngClass]="isEditMode ? 'fa-save' : 'fa-plus'"></i>
                  {{ isEditMode ? 'Update Car' : 'Add Car' }}
                </button>
              </form>
            </div>
          </div>
        </div>

        <!-- ðŸš— Right Side - Car List -->
        <div class="col-lg-7">
          <div class="row g-3">
            <div class="col-md-6" *ngFor="let car of cars; let i = index" [style.animation-delay]="i * 0.15 + 's'">
              <div class="card car-card animate-up shadow-sm">
                <div class="card-body">
                  <h5 class="card-title text-dark fw-bold">
                    {{ car.make }} - {{ car.model }}
                  </h5>
                  <p class="card-text text-secondary mb-2">
                    <i class="fas fa-calendar-alt"></i> {{ car.manufactureYear }}
                  </p>
                  <p class="text-secondary mb-2">
                    <i class="fas fa-id-card"></i> {{ car.registrationNumber }}
                  </p>
                  <span class="badge" [ngClass]="{
                    'bg-success': car.status === 'available',
                    'bg-warning text-dark': car.status === 'booked'
                  }">{{ car.status }}</span>

                  <!-- Buttons including eye icon -->
                  <div class="mt-3 d-flex justify-content-end gap-2">
                    <button class="btn btn-info btn-sm text-white" (click)="viewCarDetails(car)">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-warning btn-sm text-white" (click)="editCar(car)">
                      <i class="fas fa-pencil-alt"></i>
                    </button>
                    <button class="btn btn-danger btn-sm" (click)="deleteCar(car.id)">
                      <i class="fas fa-trash-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ðŸ” Car Details Modal -->
      <div class="modal fade" id="carDetailModal" tabindex="-1" aria-labelledby="carDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header bg-primary text-white">
              <h5 class="modal-title" id="carDetailModalLabel">Car Details</h5>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-black" *ngIf="selectedCar" >
              <p><strong>Make:</strong> {{ selectedCar.make }}</p>
              <p><strong>Model:</strong> {{ selectedCar.model }}</p>
              <p><strong>Manufacture Year:</strong> {{ selectedCar.manufactureYear }}</p>
              <p><strong>Registration Number:</strong> {{ selectedCar.registrationNumber }}</p>
              <p><strong>Status:</strong> {{ selectedCar.status }}</p>
              <p><strong>Rental Rate Per Day:</strong> {{ selectedCar.rentalRatePerDay }}</p>
              <p><strong>Category:</strong> {{ getCategoryName(selectedCar.category.id) }}</p>
            </div>
            <!-- <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div> -->
          </div>
        </div>
      </div>

    </div>
  </div>
</body>
